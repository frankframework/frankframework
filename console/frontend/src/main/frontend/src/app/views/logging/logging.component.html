<div class="wrapper wrapper-content animated fadeInRight">
  @if (alert) {
    <ngb-alert type="danger" data-cy="logging__alert" [dismissible]="false">{{ alert }}</ngb-alert>
  }
  <div class="row">
    <div class="col-lg-12">
      <div class="ibox float-e-margins">
        <div class="ibox-title">
          @if (viewFile) {
            <div class="pull-right action-buttons">
              <button class="btn btn-xs" type="button" (click)="popout(path)">
                <fa-icon aria-hidden="true" [icon]="faArrowAltCircleRight" />
                <span> Pop Out</span>
              </button>
              <button class="btn btn-xs pull-right" type="button" data-cy="logging__back-button" (click)="closeFile()">
                <fa-icon aria-hidden="true" [icon]="faArrowAltCircleLeft" />
                <span> Back</span>
              </button>
            </div>
          }
          <h4>
            Logging
            <span class="m-l-md clipboard"
              >{{ path
              }}<fa-icon
                title="copy to clipboard"
                aria-hidden="true"
                [icon]="faClipboard"
                (click)="copyAndTrimToClipboard(path)"
              />
            </span>
          </h4>
        </div>
        @if (!viewFile) {
          <div class="ibox-content">
            <div class="col-md-12">
              <div class="ibox-stretch">
                <div class="input-group" id="searchbar">
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Search ... (Ctrl + Shift + F)"
                    name="search"
                    data-cy="logging__search__input"
                    [(ngModel)]="fileName"
                  />
                  <fa-icon
                    aria-hidden="true"
                    [icon]="faTimes"
                    [class]="`input-group-closeSearch${fileName.length < 1 ? ' hidden' : ''}`"
                    (click)="fileName = ''"
                  />
                  <span class="input-group-addon">
                    <fa-icon aria-hidden="true" [icon]="faSearch" />
                  </span>
                </div>
              </div>
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th sortable="name" (sorted)="onSort($event)">Name</th>
                    <th sortable="size" (sorted)="onSort($event)">Size</th>
                    <th sortable="lastModified" (sorted)="onSort($event)">Date</th>
                    <th>&nbsp;</th>
                  </tr>
                </thead>
                <tbody>
                  @for (file of sortedlist | searchFilter: fileName; track file.path) {
                    <tr>
                      <td
                        class="pointer"
                        data-cy="logging__table__file"
                        [attr.data-file-name]="file.name"
                        (click)="open(file)"
                      >
                        {{ file.name }}
                      </td>
                      <td>
                        @if (file.type === 'file') {
                          <span>{{ file.sizeDisplay }}</span>
                        }
                      </td>
                      <td appToDate [time]="file.lastModified"></td>
                      @if (file.type === 'file') {
                        <td class="hideBtn1170">
                          <button class="btn btn-xs pull-right" type="button" (click)="download(file)">
                            <fa-icon aria-hidden="true" [icon]="faArrowAltCircleDown" />
                            <span> Download</span>
                          </button>
                          <button class="btn btn-xs pull-right" type="button" (click)="popout(file)">
                            <fa-icon aria-hidden="true" [icon]="faArrowCircleRight" />
                            <span> Pop Out</span>
                          </button>
                        </td>
                      }
                      @if (file.type === 'directory') {
                        <td class="loggingBtn">
                          <button class="btn btn-xs pull-right" type="button" (click)="open(file)">
                            <fa-icon aria-hidden="true" [icon]="faFolderOpen" />
                            <span> Open</span>
                          </button>
                        </td>
                      }
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        }
        @if (viewFile) {
          <div>
            <app-file-viewer [fileName]="viewFile" />
          </div>
        }
      </div>
    </div>
  </div>
</div>
