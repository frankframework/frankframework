# Frank!Doc user manual for contributors

As a contributor to the Frank!Framework, you write JavaDoc comments that are used to generate the Frank!Doc. This document explains how your comments appear in this user documentation. It also explains some Java annotations that you need to maintain the Frank!Doc.

## What is the Frank!Doc?

From a user perspective, the Frank!Doc consists of two parts. First, Frank developers use the file `FrankConfig-strict.xsd` that is generated by the frankDoc doclet (see [CONTRIBUTING](./CONTRIBUTING.md)). Frank developers typically get this file under the name `frankdoc.xsd`. They include a reference to this XML schema in the XML Frank configs they write. This gives them autocomplete functionality and tooltip help in their text editor.

The second part is a [web application](https://ibis4example.ibissource.org/iaf/frankdoc) with reference information about the XML-based language of Frank configurations. Both parts are shown here now to introduce you to the Frank!Doc.

#### XML schema for Frank developers

A Frank developer uses the XML schema when he writes a Frank config. He may start writing a config in Visual Studio Code as shown below:

![vscodeStartConfig](./picturesForContributors/vscodeStartConfig.jpg)

He types the text needed to reference the XML schema of the Frank!Doc (number 1). Then he writes the text `<A` (number 2). VSCode shows a red flag because this is invalid XML. VSCode can provide autocomplete help as shown (number 3). One of the options is the XML element `<Adapter>`. There is a button to get the tooltip help text of that element (number 4). This text is derived from the JavaDoc comment above the class declaration of [Adapter](./core/src/main/java/nl/nn/adapterframework/core/Adapter.java).

Frank developers not only see errors about invalid XML, but also about violations of the XML schema.

![vscodeXsdViolation](./picturesForContributors/vscodeXsdViolation.jpg)

The Frank developer has used an XML element `<xxx>` that does not exist. VSCode produces a red flag. The tooltip help he can get is also shown. He sees which XML elements he can use instead of `<xxx>`.

#### Web app with reference information for Frank developers

The XML schema helps Frank developers when they are writing their configs, but they also need help while designing them. They can use the Frank!Doc web application as the reference manual. It looks like shown below:

![webapp-intro](./picturesForContributors/webapp-intro.jpg)

To the top-left, you see a list of groups (number 1). These groups are controlled by Java annotation [@FrankDocGroup](./core/src/main/java/nl/nn/adapterframework/doc/FrankDocGroup.java). To the bottom-left, you see the Java class names that are members of the chosen group (number 2). When you select a class name, you get information about it (number 3). More explanation of this text follows later.

## Descriptions of classes, child elements and attributes

Most descriptions you see in the Frank!Doc come from JavaDoc comments. This section shows where your JavaDoc comments appear in the Frank!Doc. Below you see some snippets of Java class [Configuration](./core/src/main/java/nl/nn/adapterframework/configuration/Configuration.java).

![eclipseConfigurationJava](./picturesForContributors/eclipseConfigurationJava.jpg)

You see the JavaDoc comment of the class (number 1), the JavaDoc of a config child setter (number 2) and the JavaDoc of an attribute (number 3).

These JavaDoc comments appear in VSCode as shown below:

![vscodeConfigurationDescriptions](./picturesForContributors/vscodeConfigurationDescriptions.jpg)

The JavaDoc comment of the class appears as help about XML element `<Configuration>` (number 1). The JavaDoc of the attribute setter appears as help about the attribute (number 3). The JavaDoc of the config child setter is not in the XML schema file (number 2 is not present).

The JavaDoc of a config child setter is available in the web application as shown below.

![webappConfigurationDescriptions](./picturesForContributors/webappConfigurationDescriptions.jpg)

The JavaDoc of the class appears at the top of the page. The JavaDoc of the config child setter appears in the table of config children. And the JavaDoc of the attribute setter appears with the attributes. The name of the config child (number 4) does not come from file [Configuration.java](./core/src/main/java/nl/nn/adapterframework/configuration/Configuration.java). It comes from file [digester-rules.xml](./core/src/main/resources/digester-rules.xml), which contains the following line:

![digesterRulesRoleAdapter](./picturesForContributors/digesterRulesRoleAdapter.jpg)

There is a `<rule>` XML element that links the name `adapter` to the name of the config child setter, `registerAdapter`.

## How Java inheritance is shown

In Java, config child setters and attribute setters are inherited like any Java method. As a consequence, attributes and config children are inherited. In `FrankConfig-strict.xsd` and in the JSON, inheritance is used to avoid unnecessary repetition and reduce file sizes. Frank developers do not see this in their text editor. Attributes look the same whether they are declared or inherited, and the same is true for child elements. In the web application however, inheritance is clearly visible as shown below:

![webappInheritance](./picturesForContributors/webappInheritance.jpg)

Declared config children and declared attributes go first. If config children or attributes are inherited, there is a heading with the closest ancestor from which we have inheritance. The config children and the attributes inherited from that ancestor follow. Next comes a header for the next ancestor from which config children or attributes are inherited. The recursion ends when all declared and all inherited config children and attributes are present.

## Preferred order of attributes and child elements

The order of config child setters and attribute setters in the Java code is important for the Frank!Doc. With the old IbisDoc documentation, this is not the case because the value fields in [@IbisDoc](./core/src/main/java/nl/nn/adapterframework/doc/IbisDoc.java) and [@IbisDocRef](./core/src/main/java/nl/nn/adapterframework/doc/IbisDocRef.java) annotations can hold the order. In the Frank!Doc, the order kept in [@IbisDoc](./core/src/main/java/nl/nn/adapterframework/doc/IbisDoc.java) and [@IbisDocRef](./core/src/main/java/nl/nn/adapterframework/doc/IbisDocRef.java) annotations is ignored and the method order is used.

In the Frank!Doc web application, the order of the attributes follows the order of the methods. This order is not enforced in any way in Frank configurations, because XML schemas in general do not prescribe the order of XML attributes.

The order of the config child setters defines a *preferred* order for config children (child elements). The previous section showed config children in their preferred order. The preferred order of config children follows from the following rules:
* Declared config children go first. The preferred order of the declared config children is the sequence of the config child setters in the Java source code.
* Inherited config children go after declared config children. Config children from a closer ancestor go before config children from a further ancestor.

Frank configs that violate the preferred order can still be parsed by the Frank!Framework, which is desirable for backward compatibility. The strict XSD does enforce the order as shown below:

![vscodeOrderChecked](./picturesForContributors/vscodeOrderChecked.jpg)

## Groups in the web application

This section is about the groups shown in the top-left of the Frank!Doc web application:

![webapp-groups-batch](./picturesForContributors/webapp-groups-batch.jpg)

The overview of all groups is shown as number 1. We have selected group `Batch` (number 2). How does the Frank!Doc know the order of the groups and the elements they contain? First, see the following snippet of [IRecordHandlerManager](./core/src/main/java/nl/nn/adapterframework/batch/IRecordHandlerManager.java)

![eclipseIRecordHandlerManager](./picturesForContributors/eclipseIRecordHandlerManager.jpg)

The interface has a Java annotation [@FrankDocGroup](./core/src/main/java/nl/nn/adapterframework/doc/FrankDocGroup.java). The annotation has fields `name` and `order`. The `order` is an integer that is used to sort the groups in the shown order.

When [@FrankDocGroup](./core/src/main/java/nl/nn/adapterframework/doc/FrankDocGroup.java) is placed on a Java interface, then all Java classes that implement the interface are added to the group. Here is the type hierarchy of [IRecordHandlerManager](./core/src/main/java/nl/nn/adapterframework/batch/IRecordHandlerManager.java):

![eclipseTypeHierarchyIRecordHandlerManager](./picturesForContributors/eclipseTypeHierarchyIRecordHandlerManager.jpg)

The Java classes that implement [IRecordHandlerManager](./core/src/main/java/nl/nn/adapterframework/batch/IRecordHandlerManager.java) are highlighted. They are annotated in the first figure of this section as number 3.

The annotation on [IRecordHandlerManager](./core/src/main/java/nl/nn/adapterframework/batch/IRecordHandlerManager.java) only adds three classes to group `Batch`. The other elements are added by other [@FrankDocGroup](./core/src/main/java/nl/nn/adapterframework/doc/FrankDocGroup.java) annotations. These do not have their `order` field set, see for example [RecordHandlingFlow](./core/src/main/java/nl/nn/adapterframework/batch/RecordHandlingFlow.java)

![eclipseRecordHandlingFlow](./picturesForContributors/eclipseRecordHandlingFlow.jpg)

The annotation is placed on a class here. Then only that class is added to the group in the Frank!Doc web application.

Finally, Java classes that do not have or inherit a [@FrankDocGroup](./core/src/main/java/nl/nn/adapterframework/doc/FrankDocGroup.java) annotation are put in group `Other`.

## Attribute types

## Attribute default value

## Parameters

## Deprecated child elements and attributes

## Other JavaDoc tags

