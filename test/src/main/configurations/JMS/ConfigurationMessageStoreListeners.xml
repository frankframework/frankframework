<Configuration>
	<Module>
		<Adapter name="MultipleReceiversAdapter" description="Used to retry messages using two EsbJmsListener and a MessageStoreListener" active="${active.jms}">
			<Receiver name="localReceiver"
				elementToMove="fileContent"
				removeCompactMsgNamespaces="false"
				maxRetries="0"
				onError="RECOVER"
				stopTimeout="600">
				<JavaListener name="localListener"/>
			</Receiver>

			<Receiver name="receiver"
				elementToMove="fileContent"
				removeCompactMsgNamespaces="false"
				transactionAttribute="Required"
				maxRetries="0"
				onError="RECOVER"
				stopTimeout="600">

				<EsbJmsListener name="esbListener"
					destinationName="${jms.destination.i4testiaf_in}"
					lookupDestination="false"
					jmsRealm="qcf"
					messageProtocol="FF" />

				<JdbcErrorStorage name="errorStorage"
					slotId="testSlot" />

				<JdbcMessageLog name="messagelog"
					slotId="testSlot"
					retention="3" />
			</Receiver>

			<Receiver name="retryReceiver"
				elementToMove="fileContent"
				removeCompactMsgNamespaces="false"
				transactionAttribute="Required"
				maxRetries="0"
				forceRetryFlag="true"
				pollInterval="60">

				<MessageStoreListener name="messageStoreListener"
					datasourceName="${jdbc.datasource.default}"
					slotId="testSlot"
					statusValueInProcess="P" />
			</Receiver>

			<Pipeline firstPipe="EchoPipe">
				<Exits>
					<Exit path="EXIT" state="success" />
				</Exits>
				<EchoPipe name="EchoPipe"
					restoreMovedElements="true">
					<forward name="success" path="EXIT" />
				</EchoPipe>
			</Pipeline>
		</Adapter>
	</Module>
</Configuration>
