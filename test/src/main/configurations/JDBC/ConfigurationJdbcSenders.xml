<module>
	<adapter name="JdbcSenders" description="Test the functioning of the FixedQuerySender and DirectQuerySender">
		<receiver>
			<listener name="JdbcQuerySenderTest"
						className="nl.nn.adapterframework.receivers.JavaListener"
						serviceName="ibis4test-JdbcSenders"
			/>
		</receiver>
		<pipeline transactionAttribute="Required">
			<exits>
				<exit path="EXIT" state="success" />
			</exits>
			<pipe name="ExctractQuery" className="nl.nn.adapterframework.pipes.XsltPipe"
				xpathExpression="/request/@query" storeResultInSessionKey="query" 
			/>
			<pipe name="SwitchAction" className="nl.nn.adapterframework.pipes.XmlSwitch" 
				xpathExpression="/request/@action" getInputFromSessionKey="originalMessage"
			/>

			<pipe name="SelectDynamic1">
				<FixedQuerySender query="${dynamicQuery}" queryType="SELECT">
				<Param name="value" value="10000"/>
				</FixedQuerySender>
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="SelectDynamic2">
				<sender className="nl.nn.adapterframework.jdbc.FixedQuerySender" query="${dynamicQuery}" queryType="SELECT">
				<Param name="value" value="10000"/>
				</sender>
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="SelectStatic1">
				<FixedQuerySender query="SELECT * FROM IBISTEMP WHERE TKEY &lt; ?" queryType="SELECT">
				<Param name="value" value="10000"/>
				</FixedQuerySender>
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="SelectStatic2">
				<sender className="nl.nn.adapterframework.jdbc.FixedQuerySender" query="SELECT * FROM IBISTEMP WHERE TKEY &lt; ?" queryType="SELECT">
				<Param name="value" value="10000"/>
				</sender>
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="XsltParam" className="nl.nn.adapterframework.pipes.XsltPipe" getInputFromFixedValue="&lt;dummy/&gt;" styleSheetName="xsl/LimitDocumentNameLength.xsl">
			<pipe name="XsltParam" className="nl.nn.adapterframework.pipes.XsltPipe" getInputFromFixedValue="&lt;dummy/&gt;" styleSheetName="xsl/LimitDocumentNameLength.xsl">
				<param name="documentName" value="proof.png"/>
				<param name="replaceCharacters" value="/:*?&quot;&lt;&gt;|"/>
				<param name="replaceCharactersHyphen" value="â€“"/>
				<forward name="success" path="EXIT"/>
			</pipe>

			<pipe name="DirectQuerySender" getInputFromSessionKey="query">
				<sender className="nl.nn.adapterframework.jdbc.DirectQuerySender" queryType="select" scalar="true"/>
				<forward name="success" path="EXIT" />
			</pipe>
			<pipe name="DirectQuerySender-TwoParam" getInputFromSessionKey="query">
				<sender className="nl.nn.adapterframework.jdbc.DirectQuerySender" queryType="select" scalar="true" >
					<param name="param1" value="1" type="integer" />
					<param name="param2" value="10" type="integer" />
				</sender>
				<forward name="success" path="EXIT" />
			</pipe>
			<pipe name="DirectQuerySender-TwoPipeParam" getInputFromSessionKey="query">
				<param name="param1" value="1" type="integer" />
				<param name="param2" value="10" type="integer" />
				<sender className="nl.nn.adapterframework.jdbc.DirectQuerySender" queryType="select" scalar="true" />
				<forward name="success" path="EXIT" />
			</pipe>
			<pipe name="DirectQuerySender-TwoParamNamed" getInputFromSessionKey="query">
				<sender className="nl.nn.adapterframework.jdbc.DirectQuerySender" queryType="select" scalar="true" useNamedParams="true">
					<param name="param1" value="1" type="integer" />
					<param name="param2" value="10" type="integer" />
				</sender>
				<forward name="success" path="EXIT" />
			</pipe>
			<pipe name="DirectQuerySender-TwoPipeParamNamed" getInputFromSessionKey="query">
				<param name="param1" value="1" type="integer" />
				<param name="param2" value="10" type="integer" />
				<sender className="nl.nn.adapterframework.jdbc.DirectQuerySender" queryType="select" scalar="true" useNamedParams="true" />
				<forward name="success" path="EXIT" />
			</pipe>
		</pipeline>
	</adapter>
</module>